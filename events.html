<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      href="https://secure.meetupstatic.com/next/images/general/favicon.ico"
      type="image/x-icon"
      sizes="any"
    />
    <title>Meetup | Events</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./dist/style.css" />
  </head>
  <body>
    <header class="header">
      <div class="header__container">
        <div class="header__left">
          <a href="./index.html">
            <img
              src="./assets/svg/logo.svg"
              alt="main logo icon"
              class="header__left-logo"
            />
          </a>
          <div class="search">
            <input
              class="search__input"
              type="text"
              placeholder="Search event"
            />
            <input
              class="search__city"
              type="text"
              value="New York, NY"
              placeholder="City"
            />
            <button href="#" id="search-btn" class="search__btn">
              <img
                src="./assets/svg/search_btn.svg"
                alt="search icon"
                class="search__icon"
              />
            </button>
          </div>
        </div>
        <div class="header__right">
          <div class="header__right-language-dropdown">
            <div class="header__right-language-dropdown--icon-container">
              <img
                src="./assets/svg/language.svg"
                alt="language icon"
                class="header__right-language-dropdown--icon"
              />
            </div>
            <div class="language-selector">
              <button class="selected-language">English</button>
              <ul class="languages">
                <li data-value="en" class="selected">English</li>
                <li data-value="ru">Русский</li>
                <li data-value="fr">Français</li>
                <li data-value="de">Deutsch</li>
              </ul>
            </div>
          </div>
          <div class="header__right-registration-buttons">
            <button class="header__right-registration-buttons--login-btn">
              Log in
            </button>
            <button class="header__right-registration-buttons--signup-btn">
              Sign up
            </button>
          </div>
        </div>
      </div>
    </header>
    <main class="main">
      <div class="main__container">
          <div class="container_events">
            <div class="events-list">
              <h2 class="events-title">Events near New York, NY</h2>
              <a class="events-small-title" href="#">Events</a>
              <div class="select-box">
                <div class="select-item">
                  <select name="" id="any-type">
                    <option value="any">Any type</option>
                    <option value="online">Online</option>
                    <option value="offline">Offline</option>
                  </select>
                </div>
                <div class="select-item">
                  <select name="" id="any-distance">
                    <option value="any">Any distance</option>
                    <option value="5">5 km</option>
                    <option value="10">10 km</option>
                    <option value="15">15 km</option>
                    <option value="25">25 km</option>
                    <option value="50">50 km</option>
                    <option value="75">75 km</option>
                    <option value="100">100 km</option>
                    <!-- distance -->
                  </select>
                </div>
                <div class="select-item">
                  <select name="" id="any-category">
                    <option value="any">Any category</option>
                    <option value="Social Activities">Social Activities</option>
                    <option value="Hobbies and Passions">
                      Hobbies and Passions
                    </option>
                    <option value="Health and Wellbeing">
                      Health and Wellbeing
                    </option>
                    <option value="Business">Business</option>
                    <option value="Technology">Technology</option>
                    <!-- category -->
                  </select>
                </div>
                <div id="no-filter">Reset filters</div>
              </div>
              <div class="all-events">
                <!-- js -->
              </div>
            </div>
            <div class="map-container">
              <div class="maps">
                <p>Find events near</p>
                <h2>New York, NY</h2>
                <div class="map">
                  <div id="google-map" class="map__blurred"></div>
                  <div class="map__close">
                    <img src="./assets/svg/close_map.svg" alt="close map svg" />
                  </div>
                  <button id="map__button">
                    Browse in map<img
                      src="./assets/svg/expandMapIcon.svg"
                      alt="expand map icon"
                    />
                  </button>
                </div>
              </div>
            </div>
          </div>
      </div>
    </main>
    <footer class="footer">
      <div class="footer__container">
        <div class="footer__create-group-container">
          <p>Create your own Meetup group.</p>
          <button>Get started</button>
        </div>
        <div class="footer__nav-container">
          <nav class="footer__nav footer__nav-account">
            <p>Your Account</p>
            <a href="#">Sign up</a>
            <a href="#">Login</a>
            <a href="#">Help</a>
            <a href="#">Become an Affiliate</a>
          </nav>
          <nav class="footer__nav footer__nav-discover">
            <p>Discover</p>
            <a href="#">Groups</a>
            <a href="#">Calendar</a>
            <a href="#">Topics</a>
            <a href="#">Cities</a>
            <a href="#">Online Events</a>
            <a href="#">Local Guides</a>
            <a href="#">Make Friends</a>
          </nav>
          <nav class="footer__nav footer__nav-meetup">
            <p>Meetup</p>
            <a href="#">About</a>
            <a href="#">Blog</a>
            <a href="#">Meetup Pro</a>
            <a href="#">Careers</a>
            <a href="#">Apps</a>
            <a href="#">Podcast</a>
          </nav>
        </div>
        <div class="footer__social">
          <div class="footer__social-container">
            <p>Follow us</p>
            <ul class="footer__social-list">
              <li>
                <a href="#"
                  ><img
                    src="./assets/svg/social_networks/Facebook.svg"
                    alt="facebook"
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img
                    src="./assets/svg/social_networks/Twitter.svg"
                    alt="twitter"
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img
                    src="./assets/svg/social_networks/YouTube.svg"
                    alt="youtube"
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img
                    src="./assets/svg/social_networks/Instagram.svg"
                    alt="instagram"
                /></a>
              </li>
              <li>
                <a href="#"
                  ><img
                    src="./assets/svg/social_networks/TikTok.svg"
                    alt="tik-tok"
                /></a>
              </li>
            </ul>
          </div>
          <div class="footer__mobile-download">
            <a href="#"
              ><img src="./assets/svg/google_play.svg" alt="google play"
            /></a>
            <a href="#"
              ><img src="./assets/svg/app_store.svg" alt="appstore"
            /></a>
          </div>
        </div>
        <div class="footer__policy-container">
          <p>© 2024 Meetup</p>
          <ul class="footer__policy">
            <li><a href="#">Terms of Service</a></li>
            <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Do Not Sell or Share My Personal Data</a></li>
            <li><a href="#">Cookie Policy</a></li>
            <li><a href="#">Help</a></li>
          </ul>
        </div>
      </div>
    </footer>

    <script>
      function initMap() {
        const mapElement = document.getElementById("google-map");

        try {
          const map = new google.maps.Map(mapElement, {
            center: { lat: 40.7128, lng: -74.006 },
            zoom: 12,
          });
        } catch (error) {
          console.error("Error loading map: ", error);
          // Показать изображение вместо карты
          mapElement.innerHTML = `<img src='./assets/images/map.jpg' alt='Map is unavailable' style='width: 100%; height: 100%; object-fit: cover;'>`;
        }
      }

      const mapElement = document.getElementById("google-map");
      const mapButton = document.getElementById("map__button");
      const mapCloseButton = document.querySelector(".map__close");

      if (mapButton) {
        mapButton.addEventListener("click", () => {
          mapElement.classList.toggle("map__blurred");
          mapButton.style.display = "none";
          mapCloseButton.style.display = "none";
        });
      }

      if (mapCloseButton) {
        mapCloseButton.addEventListener("click", () => {
          mapElement.classList.toggle("map__blurred");
          mapCloseButton.style.display = "none";
          mapButton.style.display = "none";
        });
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=&callback=initMap"></script>
    <script>
      const eventsStore = [
        {
          title: "INFJ Personality Type - Coffee Shop Meet & Greet",
          description: "Being an INFJ",
          date: new Date(2024, 2, 23, 15),
          image:
            "https://images.unsplash.com/photo-1541167760496-1628856ab772?q=80&w=1037&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D%201037w ",
          type: "offline",
          attendees: 99,
          category: "Hobbies and Passions",
          distance: 50,
        },
        {
          title:
            "NYC AI Users - AI Tech Talks, Demo & Social: RAG Search and Customer Experience",
          description: "New York AI Users",
          date: new Date(2024, 2, 23, 11, 30),
          image:
            "https://images.unsplash.com/photo-1696258686454-60082b2c33e2?q=80&w=870&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
          type: "offline",
          attendees: 43,
          category: "Technology",
          distance: 25,
        },
        {
          title: "Book 40+ Appointments Per Month Using AI and Automation",
          description: "New Jersey Business Network",
          date: new Date(2024, 2, 16, 14),
          image:
            "https://images.unsplash.com/photo-1674027444485-cec3da58eef4?q=80&w=1032&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
          type: "online",
          category: "Technology",
          distance: 10,
        },
        {
          title: "Dump writing group weekly meetup",
          description: "Dump writing group",
          date: new Date(2024, 2, 13, 11),

          image:
            "https://plus.unsplash.com/premium_photo-1678453146992-b80d66df9152?q=80&w=870&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
          type: "online",
          attendees: 77,
          category: "Business",
          distance: 100,
        },
        {
          title:
            "Over 40s, 50s, & 60s Senior Singles Chat, Meet & Dating Community",
          description:
            "Over 40s, 50s, 60s Singles Chat, Meet & Dating Community",
          date: new Date(2024, 2, 14, 11),
          image:
            "https://plus.unsplash.com/premium_photo-1706005542509-a460d6efecb0?q=80&w=870&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
          type: "online",
          attendees: 140,
          category: "Social Activities",
          distance: 75,
        },
        {
          title: "All Nations - Manhattan Missions Church Bible Study",
          description: "Manhattan Bible Study Meetup Group",
          date: new Date(2024, 2, 14, 11),
          image:
            "https://plus.unsplash.com/premium_photo-1679488248784-65a638a3d3fc?q=80&w=870&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
          type: "offline",
          category: "Health and Wellbeing",
          distance: 15,
        },
      ];

      function formatDate(date) {
        const newDate = new Date(date);
        const optionsDays = {
          weekday: "short",
          month: "short",
          day: "2-digit",
        };
        const optionsHours = {
          hour: "2-digit",
          minute: "2-digit",
          hour12: true,
          timeZone: "UTC",
          timeZoneName: "short",
        };
        const formatedDays = new Intl.DateTimeFormat(
          "en-US",
          optionsDays
        ).format(newDate);
        const formatedHours = new Intl.DateTimeFormat(
          "en-US",
          optionsHours
        ).format(newDate);
        return `${formatedDays} · ${formatedHours} `;
      }

      const allEventsDiv = document.querySelector(".all-events");
      const eventTypeSelect = document.getElementById("any-type");
      const eventDistanceSelect = document.getElementById("any-distance");
      const eventCategorySelect = document.getElementById("any-category");

      function createEvent(arr) {
        allEventsDiv.innerHTML = "";

        arr.forEach((eventElement) => {
          const item = document.createElement("li");
          item.className = "all-events-link";
          item.href = "#";

          item.innerHTML = `
      <div class="all-events-img-box">
        <img class="all-events-img" src="${eventElement.image}" alt="Event image">
      </div>
      <div class="all-events-info">
        <p class="all-events-date">${formatDate(eventElement.date)}</p>
        <h3 class="all-events-header"><a href="#">${eventElement.title}</a></h3>
        <p class="all-events-category">${eventElement.category}</p>
        ${
          eventElement.attendees
            ? `<p class="all-events-attendees">${eventElement.attendees} attendees</p>`
            : ""
        }
      </div>
    `;

          if (eventElement.type === "online") {
            const onlineEventDiv = document.createElement("div");
            onlineEventDiv.className = "all-events-online";

            const smallOnlineEventDiv = document.createElement("div");
            smallOnlineEventDiv.className = "all-events-online-small";

            onlineEventDiv.innerHTML = `
        <img class="all-events-online-img" src="./assets/svg/online_event.svg" alt="Online event">
      `;

            smallOnlineEventDiv.innerHTML = `
        <img class="all-events-online-small-img" src="./assets/svg/online_event_small.svg" alt="Online event, small">
      `;

            item
              .querySelector(".all-events-info")
              .append(onlineEventDiv, smallOnlineEventDiv);
          }

          allEventsDiv.appendChild(item);
        });
      }

      function clearEvents() {
        allEventsDiv.innerHTML = "";
      }

      function filterEvents(arr) {
        const selectedType =
          eventTypeSelect.value !== "any" ? eventTypeSelect.value : undefined;
        const selectedDistance =
          eventDistanceSelect.value !== "any"
            ? eventDistanceSelect.value
            : undefined;
        const selectedCategory =
          eventCategorySelect.value !== "any"
            ? eventCategorySelect.value
            : undefined;

        let filteredArr = arr;
        if (selectedType) {
          filteredArr = filteredArr.filter(
            (element) => element.type === selectedType
          );
        }
        if (selectedDistance) {

          filteredArr = filteredArr.filter(
            (element) => Number(element.distance) <= Number(selectedDistance)
          );
        }
        if (selectedCategory) {
          filteredArr = filteredArr.filter(
            (element) => element.category === selectedCategory
          );
        }

        clearEvents();
        createEvent(filteredArr);
      }

      eventTypeSelect.addEventListener("change", () =>
        filterEvents(eventsStore)
      );
      eventDistanceSelect.addEventListener("change", () =>
        filterEvents(eventsStore)
      );
      eventCategorySelect.addEventListener("change", () =>
        filterEvents(eventsStore)
      );

      createEvent(eventsStore);

      function resetFilters() {
        eventTypeSelect.value = "any";
        eventDistanceSelect.value = "any";
        eventCategorySelect.value = "any";

        createEvent(eventsStore);
      }

      const resetButton = document.getElementById("no-filter");
      resetButton.addEventListener("click", resetFilters);
    </script>
    <script type="module" src="./script.js"></script>
  </body>
</html>
